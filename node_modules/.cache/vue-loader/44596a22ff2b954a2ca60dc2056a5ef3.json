{"remainingRequest":"C:\\Users\\Lenovo\\Downloads\\Compressed\\travel-master\\travel-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Lenovo\\Downloads\\Compressed\\travel-master\\travel-master\\src\\pages\\home\\home.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Lenovo\\Downloads\\Compressed\\travel-master\\travel-master\\src\\pages\\home\\home.vue","mtime":1596367404000},{"path":"C:\\Users\\Lenovo\\Downloads\\Compressed\\travel-master\\travel-master\\node_modules\\babel-loader\\lib\\index.js","mtime":1708077616092},{"path":"C:\\Users\\Lenovo\\Downloads\\Compressed\\travel-master\\travel-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1708077614823},{"path":"C:\\Users\\Lenovo\\Downloads\\Compressed\\travel-master\\travel-master\\node_modules\\vue-loader\\lib\\index.js","mtime":1708077599485}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapState } from 'vuex'\nimport homeHeader from './components/header'\nimport homeSwiper from './components/swiper'\nimport homeLocalNav from './components/localNav'\nimport homeGridNav from './components/gridNav'\nimport homeSubnav from './components/subnav'\nimport homePopular from './components/popular'\nimport homeRecommend from './components/recommend'\nimport homeLocalHot from './components/lovalHot'\nimport homeWaterfall from './components/waterfall'\n\nexport default {\n  name: 'home',\n  created() {\n    this.getHomeData()\n  },\n  activated() {\n    this.$refs.homeScroll.refresh()\n  },\n  updated() {\n    this.localHotOffsetTop = this.$refs.localHot.$el.offsetTop\n  },\n  data() {\n    return {\n      // 轮播图数据\n      swiperImages: [],\n      // 本地导航数据\n      localNavs: [],\n      // 格子导航数据\n      gridNavs: [],\n      // 子导航数据\n      subnavs: [],\n      // 排行榜数据\n      popularList: [],\n      // 玩法研究院数据\n      recommend: [],\n      // 当地热门数据\n      localHot: [],\n      // better-scroll配置\n      scrollOption: {\n        probeType: 3,\n        bounce: {\n          top: false,\n          bottom: false,\n          left: false,\n          right: false\n        },\n        pullUpLoad: {\n          threshold: 50\n        }\n      },\n      // 滚动区域的y坐标\n      scrollY: 0,\n      // 当地热门的offsetTop\n      localHotOffsetTop: Infinity,\n      // 景点信息列表\n      sight: [],\n      // 当前请求的页数(初始为0)\n      pagenum: 0,\n      // 每页数据条数\n      pagesize: 10\n    }\n  },\n  computed: {\n    // 顶部的当地热门是否可见的标识\n    topLocalHotVisible() {\n      return -this.scrollY > this.localHotOffsetTop\n    },\n    ...mapState(['currentCity'])\n  },\n  watch: {\n    // 当前城市变化后重新获得首页数据\n    currentCity() {\n      this.getHomeData()\n    }\n  },\n  methods: {\n    // 获取首页数据\n    async getHomeData() {\n      const { data: result } = await this.$http.get(\n        'data/home.json?cityid=' + this.currentCity.id\n      )\n      if (!result.ret) return\n      const data = result.data\n      this.swiperImages = data.swiperImages\n      this.localNavs = data.localNavs\n      this.gridNavs = data.gridNavs\n      this.subnavs = data.subnavs\n      this.popularList = data.popularList\n      this.recommend = data.recommend\n      this.localHot = data.localHot\n      this.getSightData()\n    },\n    // 获取景点列表数据\n    async getSightData() {\n      this.pagenum++\n      const { data: result } = await this.$http.get(\n        `data/sight${(this.pagenum - 1) % 2}.json`,\n        {\n          params: {\n            cityid: this.currentCity.id,\n            pagenum: this.pagenum,\n            pagesize: this.pagesize\n          }\n        }\n      )\n      this.sight = [...this.sight, ...result]\n    },\n    // 页面滚动事件，获取y坐标\n    handleScroll({ y }) {\n      this.scrollY = Math.ceil(y)\n    },\n    // 上拉数据加载完成\n    finishPullUp() {\n      this.$refs.homeScroll.finishPullUp()\n    }\n  },\n  components: {\n    homeHeader,\n    homeSwiper,\n    homeLocalNav,\n    homeGridNav,\n    homeSubnav,\n    homePopular,\n    homeRecommend,\n    homeLocalHot,\n    homeWaterfall\n  }\n}\n",{"version":3,"sources":["home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"home.vue","sourceRoot":"src/pages/home","sourcesContent":["<template>\n  <div>\n    <home-header :scroll-y=\"scrollY\"></home-header>\n    <home-local-hot\n      :localHot=\"localHot\"\n      v-show=\"topLocalHotVisible\"\n    ></home-local-hot>\n    <better-scroll\n      class=\"home-scroll\"\n      :ref=\"'homeScroll'\"\n      :options=\"scrollOption\"\n      @scroll=\"handleScroll\"\n      @pullingUp=\"getSightData\"\n    >\n      <div class=\"content\">\n        <home-swiper :swiperImages=\"swiperImages\"></home-swiper>\n        <home-local-nav :localNavs=\"localNavs\"></home-local-nav>\n        <home-grid-nav :gridNavs=\"gridNavs\"></home-grid-nav>\n        <home-subnav :subnavs=\"subnavs\"></home-subnav>\n        <div class=\"welcome\">\n          <div class=\"weather\">\n            <svg class=\"icon\" aria-hidden=\"true\">\n              <use xlink:href=\"#iconduoyun\" />\n            </svg>\n            <span class=\"temperature\">35℃</span>\n          </div>\n          您好,欢迎来到{{ currentCity.name }}\n        </div>\n        <home-popular :popularList=\"popularList\"></home-popular>\n        <home-recommend :recommend=\"recommend\"></home-recommend>\n        <home-local-hot :localHot=\"localHot\" ref=\"localHot\"></home-local-hot>\n        <home-waterfall\n          :sight=\"sight\"\n          :pagenum=\"pagenum\"\n          :pagesize=\"pagesize\"\n          @finishPullUp=\"finishPullUp\"\n        ></home-waterfall>\n      </div>\n    </better-scroll>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex'\nimport homeHeader from './components/header'\nimport homeSwiper from './components/swiper'\nimport homeLocalNav from './components/localNav'\nimport homeGridNav from './components/gridNav'\nimport homeSubnav from './components/subnav'\nimport homePopular from './components/popular'\nimport homeRecommend from './components/recommend'\nimport homeLocalHot from './components/lovalHot'\nimport homeWaterfall from './components/waterfall'\n\nexport default {\n  name: 'home',\n  created() {\n    this.getHomeData()\n  },\n  activated() {\n    this.$refs.homeScroll.refresh()\n  },\n  updated() {\n    this.localHotOffsetTop = this.$refs.localHot.$el.offsetTop\n  },\n  data() {\n    return {\n      // 轮播图数据\n      swiperImages: [],\n      // 本地导航数据\n      localNavs: [],\n      // 格子导航数据\n      gridNavs: [],\n      // 子导航数据\n      subnavs: [],\n      // 排行榜数据\n      popularList: [],\n      // 玩法研究院数据\n      recommend: [],\n      // 当地热门数据\n      localHot: [],\n      // better-scroll配置\n      scrollOption: {\n        probeType: 3,\n        bounce: {\n          top: false,\n          bottom: false,\n          left: false,\n          right: false\n        },\n        pullUpLoad: {\n          threshold: 50\n        }\n      },\n      // 滚动区域的y坐标\n      scrollY: 0,\n      // 当地热门的offsetTop\n      localHotOffsetTop: Infinity,\n      // 景点信息列表\n      sight: [],\n      // 当前请求的页数(初始为0)\n      pagenum: 0,\n      // 每页数据条数\n      pagesize: 10\n    }\n  },\n  computed: {\n    // 顶部的当地热门是否可见的标识\n    topLocalHotVisible() {\n      return -this.scrollY > this.localHotOffsetTop\n    },\n    ...mapState(['currentCity'])\n  },\n  watch: {\n    // 当前城市变化后重新获得首页数据\n    currentCity() {\n      this.getHomeData()\n    }\n  },\n  methods: {\n    // 获取首页数据\n    async getHomeData() {\n      const { data: result } = await this.$http.get(\n        'data/home.json?cityid=' + this.currentCity.id\n      )\n      if (!result.ret) return\n      const data = result.data\n      this.swiperImages = data.swiperImages\n      this.localNavs = data.localNavs\n      this.gridNavs = data.gridNavs\n      this.subnavs = data.subnavs\n      this.popularList = data.popularList\n      this.recommend = data.recommend\n      this.localHot = data.localHot\n      this.getSightData()\n    },\n    // 获取景点列表数据\n    async getSightData() {\n      this.pagenum++\n      const { data: result } = await this.$http.get(\n        `data/sight${(this.pagenum - 1) % 2}.json`,\n        {\n          params: {\n            cityid: this.currentCity.id,\n            pagenum: this.pagenum,\n            pagesize: this.pagesize\n          }\n        }\n      )\n      this.sight = [...this.sight, ...result]\n    },\n    // 页面滚动事件，获取y坐标\n    handleScroll({ y }) {\n      this.scrollY = Math.ceil(y)\n    },\n    // 上拉数据加载完成\n    finishPullUp() {\n      this.$refs.homeScroll.finishPullUp()\n    }\n  },\n  components: {\n    homeHeader,\n    homeSwiper,\n    homeLocalNav,\n    homeGridNav,\n    homeSubnav,\n    homePopular,\n    homeRecommend,\n    homeLocalHot,\n    homeWaterfall\n  }\n}\n</script>\n\n<style lang=\"stylus\" scoped>\n.home-scroll {\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-color: #f8f8f8;\n\n  .welcome {\n    position: relative;\n    margin-bottom: 0.2rem;\n    font-size: 0.32rem;\n    text-align: center;\n    line-height: 0.64rem;\n\n    .weather {\n      position: absolute;\n      left: 0.24rem;\n\n      .icon {\n        font-size: 0.5rem;\n      }\n\n      .temperature {\n        font-size: 0.24rem;\n      }\n    }\n  }\n}\n</style>\n"]}]}